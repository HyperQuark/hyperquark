const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DE6qpayI.js","assets/index-C5mrVLYE.js","assets/index-Bh5bQtup.css","assets/index-BAMY2Nnw.js","assets/index-BATEtbik.js"])))=>i.map(i=>d[i]);
import{B as ve,C as we,_ as xe,r as F,m as Ae,c as ce,o as ee,h as Te,k as Fe,s as ge,D as De,u as j,a as b,d as W,t as V,w as Ee,L as Oe,F as Ce}from"./index-C5mrVLYE.js";import{_ as Le,g as N}from"./settings-CE5SseLH.js";const Pe="/hyperquark/look-again/assets/hyperquark_bg-CsvjNKyK.wasm";let r;function Me(t){r=t}let q=null;function O(){return(q===null||q.byteLength===0)&&(q=new Uint8Array(r.memory.buffer)),q}const ue=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let G=new ue("utf-8",{ignoreBOM:!0,fatal:!0});G.decode();const ze=2146435072;let te=0;function Be(t,e){return te+=e,te>=ze&&(G=new ue("utf-8",{ignoreBOM:!0,fatal:!0}),G.decode(),te=e),G.decode(O().subarray(t,t+e))}function v(t,e){return t=t>>>0,Be(t,e)}function se(t,e){return t=t>>>0,O().subarray(t/1,t/1+e)}function be(t){const e=r.__externref_table_alloc();return r.__wbindgen_export_2.set(e,t),e}function Ve(t,e){try{return t.apply(this,e)}catch(n){const _=be(n);r.__wbindgen_exn_store(_)}}function K(t){return t==null}function _e(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const s=t.description;return s==null?"Symbol":`Symbol(${s})`}if(e=="function"){const s=t.name;return typeof s=="string"&&s.length>0?`Function(${s})`:"Function"}if(Array.isArray(t)){const s=t.length;let a="[";s>0&&(a+=_e(t[0]));for(let c=1;c<s;c++)a+=", "+_e(t[c]);return a+="]",a}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let _;if(n&&n.length>1)_=n[1];else return toString.call(t);if(_=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:_}let u=0;const Re=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder,J=new Re("utf-8"),Ue=typeof J.encodeInto=="function"?function(t,e){return J.encodeInto(t,e)}:function(t,e){const n=J.encode(t);return e.set(n),{read:t.length,written:n.length}};function S(t,e,n){if(n===void 0){const w=J.encode(t),i=e(w.length,1)>>>0;return O().subarray(i,i+w.length).set(w),u=w.length,i}let _=t.length,s=e(_,1)>>>0;const a=O();let c=0;for(;c<_;c++){const w=t.charCodeAt(c);if(w>127)break;a[s+c]=w}if(c!==_){c!==0&&(t=t.slice(c)),s=n(s,_,_=c+t.length*3,1)>>>0;const w=O().subarray(s+c,s+_),i=Ue(t,w);c+=i.written,s=n(s,_,c,1)>>>0}return u=c,s}let E=null;function x(){return(E===null||E.buffer.detached===!0||E.buffer.detached===void 0&&E.buffer!==r.memory.buffer)&&(E=new DataView(r.memory.buffer)),E}function Ie(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`)}function C(t){const e=r.__wbindgen_export_2.get(t);return r.__externref_table_dealloc(t),e}function $e(t,e){const n=S(t,r.__wbindgen_malloc,r.__wbindgen_realloc),_=u;Ie(e,U);var s=e.__destroy_into_raw();const a=r.sb3_to_wasm(n,_,s);if(a[2])throw C(a[1]);return Y.__wrap(a[0])}function We(t,e){const n=e(t.length*1,1)>>>0;return O().set(t,n/1),u=t.length,n}function de(t,e){t=t>>>0;const n=x(),_=[];for(let s=t;s<t+4*e;s+=4)_.push(r.__wbindgen_export_2.get(n.getUint32(s,!0)));return r.__externref_drop_slice(t,e),_}function me(t,e){const n=e(t.length*4,4)>>>0;for(let _=0;_<t.length;_++){const s=be(t[_]);x().setUint32(n+4*_,s,!0)}return u=t.length,n}const le=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>r.__wbg_finishedwasm_free(t>>>0,1));class Y{static __wrap(e){e=e>>>0;const n=Object.create(Y.prototype);return n.__wbg_ptr=e,le.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,le.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_finishedwasm_free(e,0)}get wasm_bytes(){const e=r.__wbg_get_finishedwasm_wasm_bytes(this.__wbg_ptr);var n=se(e[0],e[1]).slice();return r.__wbindgen_free(e[0],e[1]*1,1),n}set wasm_bytes(e){const n=We(e,r.__wbindgen_malloc),_=u;r.__wbg_set_finishedwasm_wasm_bytes(this.__wbg_ptr,n,_)}get target_names(){const e=r.__wbg_get_finishedwasm_target_names(this.__wbg_ptr);var n=de(e[0],e[1]).slice();return r.__wbindgen_free(e[0],e[1]*4,4),n}set target_names(e){const n=me(e,r.__wbindgen_malloc),_=u;r.__wbg_set_finishedwasm_target_names(this.__wbg_ptr,n,_)}}const fe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>r.__wbg_flaginfo_free(t>>>0,1));class re{static __wrap(e){e=e>>>0;const n=Object.create(re.prototype);return n.__wbg_ptr=e,fe.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,fe.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_flaginfo_free(e,0)}get name(){let e,n;try{const _=r.__wbg_get_flaginfo_name(this.__wbg_ptr);return e=_[0],n=_[1],v(_[0],_[1])}finally{r.__wbindgen_free(e,n,1)}}set name(e){const n=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),_=u;r.__wbg_set_flaginfo_name(this.__wbg_ptr,n,_)}get description(){let e,n;try{const _=r.__wbg_get_flaginfo_description(this.__wbg_ptr);return e=_[0],n=_[1],v(_[0],_[1])}finally{r.__wbindgen_free(e,n,1)}}set description(e){const n=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),_=u;r.__wbg_set_flaginfo_description(this.__wbg_ptr,n,_)}get ty(){let e,n;try{const _=r.__wbg_get_flaginfo_ty(this.__wbg_ptr);return e=_[0],n=_[1],v(_[0],_[1])}finally{r.__wbindgen_free(e,n,1)}}set ty(e){const n=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),_=u;r.__wbg_set_flaginfo_ty(this.__wbg_ptr,n,_)}wasm_features(e){const n=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),_=u,s=r.flaginfo_wasm_features(this.__wbg_ptr,n,_);let a;return s[0]!==0&&(a=de(s[0],s[1]).slice(),r.__wbindgen_free(s[0],s[1]*4,4)),a}to_js(){const e=r.flaginfo_to_js(this.__wbg_ptr);if(e[2])throw C(e[1]);return C(e[0])}}const ne=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>r.__wbg_wasmflags_free(t>>>0,1));class U{static __wrap(e){e=e>>>0;const n=Object.create(U.prototype);return n.__wbg_ptr=e,ne.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,ne.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_wasmflags_free(e,0)}get string_type(){return r.__wbg_get_wasmflags_string_type(this.__wbg_ptr)}set string_type(e){r.__wbg_set_wasmflags_string_type(this.__wbg_ptr,e)}get wasm_opt(){return r.__wbg_get_wasmflags_wasm_opt(this.__wbg_ptr)}set wasm_opt(e){r.__wbg_set_wasmflags_wasm_opt(this.__wbg_ptr,e)}get scheduler(){return r.__wbg_get_wasmflags_scheduler(this.__wbg_ptr)}set scheduler(e){r.__wbg_set_wasmflags_scheduler(this.__wbg_ptr,e)}get print_ir(){return r.__wbg_get_wasmflags_print_ir(this.__wbg_ptr)}set print_ir(e){r.__wbg_set_wasmflags_print_ir(this.__wbg_ptr,e)}get integers(){return r.__wbg_get_wasmflags_integers(this.__wbg_ptr)}set integers(e){r.__wbg_set_wasmflags_integers(this.__wbg_ptr,e)}constructor(e){const n=me(e,r.__wbindgen_malloc),_=u,s=r.wasmflags_new(n,_);return this.__wbg_ptr=s>>>0,ne.register(this,this.__wbg_ptr,this),this}to_js(){const e=r.wasmflags_to_js(this.__wbg_ptr);if(e[2])throw C(e[1]);return C(e[0])}static from_js(e){const n=r.wasmflags_from_js(e);if(n[2])throw C(n[1]);return U.__wrap(n[0])}static flag_info(e){const n=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),_=u,s=r.wasmflags_flag_info(n,_);return re.__wrap(s)}}function qe(t,e){return Error(v(t,e))}function Ne(t){return Object.entries(t)}function Ge(){return Ve(function(t,e){globalThis.crypto.getRandomValues(se(t,e))},arguments)}function Je(t,e){return t[e>>>0]}function He(t,e){return t[e]}function Ke(t){let e;try{e=t instanceof ArrayBuffer}catch{e=!1}return e}function Xe(t){let e;try{e=t instanceof Uint8Array}catch{e=!1}return e}function Ye(t){return t.length}function Qe(t){return t.length}function Ze(t,e){console.log(v(t,e))}function et(){return new Object}function tt(){return new Map}function nt(t){return new Uint8Array(t)}function _t(){return new Array}function st(t,e,n){Uint8Array.prototype.set.call(se(t,e),n)}function rt(t,e,n){return t.set(e,n)}function ot(t,e,n){t[e]=n}function it(t,e,n){t[e>>>0]=n}function at(t,e){console.warn(v(t,e))}function ct(t){const e=t,n=typeof e=="boolean"?e:void 0;return K(n)?16777215:n?1:0}function gt(t,e){const n=_e(e),_=S(n,r.__wbindgen_malloc,r.__wbindgen_realloc),s=u;x().setInt32(t+4,s,!0),x().setInt32(t+0,_,!0)}function lt(t,e){return t in e}function ft(t){const e=t;return typeof e=="object"&&e!==null}function wt(t){return typeof t=="string"}function ut(t){return t===void 0}function bt(t,e){return t==e}function dt(t,e){const n=e,_=typeof n=="number"?n:void 0;x().setFloat64(t+8,K(_)?0:_,!0),x().setInt32(t+0,!K(_),!0)}function mt(t,e){const n=e,_=typeof n=="string"?n:void 0;var s=K(_)?0:S(_,r.__wbindgen_malloc,r.__wbindgen_realloc),a=u;x().setInt32(t+4,a,!0),x().setInt32(t+0,s,!0)}function pt(t,e){throw new Error(v(t,e))}function ht(t){let e;try{e=+t}catch(_){e=_}return e}function yt(t,e){return v(t,e)}function kt(t){return t}function jt(){const t=r.__wbindgen_export_2,e=t.grow(4);t.set(0,void 0),t.set(e+0,void 0),t.set(e+1,null),t.set(e+2,!0),t.set(e+3,!1)}URL=globalThis.URL;const o=await Le({"./hyperquark_bg.js":{__wbg_log_aa56095730005220:Ze,__wbg_warn_696c245f3c7d1eea:at,__wbg_getwithrefkey_1dc361bd10053bfe:He,__wbg_set_3f1d0b984ed272ed:ot,__wbg_new_9190433fb67ed635:nt,__wbg_length_904c0910ed998bf3:Qe,__wbg_prototypesetcall_c5f74efd31aea86b:st,__wbg_instanceof_Uint8Array_91f3c5adee7e6672:Xe,__wbg_instanceof_ArrayBuffer_59339a3a6f0c10ea:Ke,__wbg_new_56407f99198feff7:tt,__wbg_set_31197016f65a6a19:rt,__wbg_get_59c6316d15f9f1d0:Je,__wbg_new_e969dc3f68d25093:_t,__wbg_set_d636a0463acf1dbc:it,__wbg_length_246fa1f85a0dea5b:Ye,__wbg_new_1930cbb8d9ffc31b:et,__wbg_entries_17f7acbc2d691c0d:Ne,__wbg_getRandomValues_38a1ff1ea09f6cc7:Ge,__wbg_wbindgenin_192b210aa1c401e9:lt,__wbg_wbindgenthrow_4c11a24fca429ccf:pt,__wbg_Error_1f3748b298f99708:qe,__wbg_wbindgenisobject_dfe064a121d87553:ft,__wbg_wbindgenisstring_4b74e4111ba029e6:wt,__wbg_wbindgennumberget_d855f947247a3fbc:dt,__wbg_wbindgenstringget_43fe05afe34b0cb1:mt,__wbg_wbindgenbooleanget_59f830b1a70d2530:ct,__wbg_wbindgenisundefined_71f08a6ade4354e7:ut,__wbg_wbindgenjsvallooseeq_9dd7bb4b95ac195c:bt,__wbg_wbindgentryintonumber_c9e75d941453b6d7:ht,__wbg_wbindgendebugstring_bb652b1bc2061b6d:gt,__wbindgen_init_externref_table:jt,__wbindgen_cast_2241b6af4c4b2941:yt,__wbindgen_cast_d6cd19b81560fd6e:kt}},Pe),St=o.memory,vt=o.sb3_to_wasm,xt=o.__wbg_finishedwasm_free,At=o.__wbg_get_finishedwasm_target_names,Tt=o.__wbg_get_finishedwasm_wasm_bytes,Ft=o.__wbg_set_finishedwasm_target_names,Dt=o.__wbg_set_finishedwasm_wasm_bytes,Et=o.__wbg_flaginfo_free,Ot=o.__wbg_get_flaginfo_description,Ct=o.__wbg_get_flaginfo_name,Lt=o.__wbg_get_flaginfo_ty,Pt=o.__wbg_get_wasmflags_integers,Mt=o.__wbg_get_wasmflags_print_ir,zt=o.__wbg_get_wasmflags_scheduler,Bt=o.__wbg_get_wasmflags_string_type,Vt=o.__wbg_get_wasmflags_wasm_opt,Rt=o.__wbg_set_flaginfo_description,Ut=o.__wbg_set_flaginfo_name,It=o.__wbg_set_flaginfo_ty,$t=o.__wbg_set_wasmflags_integers,Wt=o.__wbg_set_wasmflags_print_ir,qt=o.__wbg_set_wasmflags_scheduler,Nt=o.__wbg_set_wasmflags_string_type,Gt=o.__wbg_set_wasmflags_wasm_opt,Jt=o.__wbg_wasmflags_free,Ht=o.all_wasm_features,Kt=o.flaginfo_to_js,Xt=o.flaginfo_wasm_features,Yt=o.wasm_feature_detect_name,Qt=o.wasmflags_flag_info,Zt=o.wasmflags_from_js,en=o.wasmflags_new,tn=o.wasmflags_to_js,nn=o.__wbindgen_exn_store,_n=o.__externref_table_alloc,sn=o.__wbindgen_export_2,rn=o.__wbindgen_malloc,on=o.__wbindgen_realloc,an=o.__externref_table_dealloc,cn=o.__wbindgen_free,gn=o.__externref_drop_slice,pe=o.__wbindgen_start,ln=Object.freeze(Object.defineProperty({__proto__:null,__externref_drop_slice:gn,__externref_table_alloc:_n,__externref_table_dealloc:an,__wbg_finishedwasm_free:xt,__wbg_flaginfo_free:Et,__wbg_get_finishedwasm_target_names:At,__wbg_get_finishedwasm_wasm_bytes:Tt,__wbg_get_flaginfo_description:Ot,__wbg_get_flaginfo_name:Ct,__wbg_get_flaginfo_ty:Lt,__wbg_get_wasmflags_integers:Pt,__wbg_get_wasmflags_print_ir:Mt,__wbg_get_wasmflags_scheduler:zt,__wbg_get_wasmflags_string_type:Bt,__wbg_get_wasmflags_wasm_opt:Vt,__wbg_set_finishedwasm_target_names:Ft,__wbg_set_finishedwasm_wasm_bytes:Dt,__wbg_set_flaginfo_description:Rt,__wbg_set_flaginfo_name:Ut,__wbg_set_flaginfo_ty:It,__wbg_set_wasmflags_integers:$t,__wbg_set_wasmflags_print_ir:Wt,__wbg_set_wasmflags_scheduler:qt,__wbg_set_wasmflags_string_type:Nt,__wbg_set_wasmflags_wasm_opt:Gt,__wbg_wasmflags_free:Jt,__wbindgen_exn_store:nn,__wbindgen_export_2:sn,__wbindgen_free:cn,__wbindgen_malloc:rn,__wbindgen_realloc:on,__wbindgen_start:pe,all_wasm_features:Ht,flaginfo_to_js:Kt,flaginfo_wasm_features:Xt,memory:St,sb3_to_wasm:vt,wasm_feature_detect_name:Yt,wasmflags_flag_info:Qt,wasmflags_from_js:Zt,wasmflags_new:en,wasmflags_to_js:tn},Symbol.toStringTag,{value:"Module"}));Me(ln);pe();let H,oe=!1,R,X,he,ye,ke;function fn(t,e,n,_,s){H=t,R=H.map(a=>null),console.log(H,R),X=e,he=n,ye=_,ke=s,oe=!0}function wn(){return oe}function L(){if(!oe)throw new Error("shared state must be set up before use!")}function P(){return L(),H}function A(){return L(),X}function ie(){return L(),he}function Q(){return L(),ye}function un(){return L(),ke}function M(t,e,n){L(),R[t]?X.updateTextSkin(R[t][0],e,n,!1):R[t]=X.createSkin("text","sprite",e,n,!1)}function bn(t,e,n){A().getDrawable(Q()[n][1]).updatePosition([t,e])}function dn(t){return t.toString()}function mn(t){return parseFloat(t)}function pn(t){return t.toString()}function hn(t){return t.length}function yn(t,e,n){return t.substring(e,n)}function kn(t,e){return t.concat(e)}function jn(t,e){console.log("%s thinks: %s",P()[e],t)}function Sn(t,e){M(e,"think",t)}function vn(t,e){M(e,"say",t.toString())}function xn(t,e){console.log("%s says: %s",P()[e],t)}function An(t,e){M(e,"say",t.toString())}function Tn(t,e){console.log("%s thinks: %d",P()[e],t)}function Fn(t,e){M(e,"think",t.toString())}function Dn(t,e){const n=un()[e][t];A().getSkin(Q()[e][0]).setSVG(n.data)}function En(t,e){console.log("%s says: %d",P()[e],t)}function On(t,e){M(e,"say",t)}function Cn(t,e){console.log("%s says: %d",P()[e],t)}function Ln(t,e){A().getDrawable(Q()[e][1]).updateVisible(t)}function Pn(t,e){M(e,"think",t.toString())}function Mn(t,e){A().getDrawable(Q()[e][1]).updateScale([t,t])}function zn(t,e){console.log("%s thinks: %d",P()[e],t)}function Bn(){const e=new Date(2e3,0,1),n=new Date,_=n.getTimezoneOffset()-e.getTimezoneOffset();let s=n.valueOf()-e.valueOf();return s+=(n.getTimezoneOffset()-_)*60*1e3,s/864e5}function Vn(t,e){return t.toLowerCase()===e.toLowerCase()}function Rn(t,e){return t.toLowerCase().includes(e.toLowerCase())}function Un(t,e){return t.toLowerCase()>e.toLowerCase()}function In(t,e){return t.toLowerCase()<e.toLowerCase()}function $n(){A().penClear(ie())}function Wn(t,e,n,_,s,a,c){console.log("called pen point with rgba color %n %n %n %n",_,s,a,c),A().penPoint(ie(),{diameter:t,color4f:[_,s,a,c]},e,n)}function qn(t,e,n,_,s,a,c,w,i){console.log("called pen line with rgba color %n %n %n %n",a,c,w,i),A().penLine(ie(),{diameter:t,color4f:[a,c,w,i]},e,n,_,s)}const Nn={pen:{clear:$n,point:Wn,line:qn},"wasm:js-string":{length:hn,substring:yn,concat:kn},operator:{eq_string:Vn,contains:Rn,gt_string:Un,lt_string:In},sensing:{dayssince2000:Bn},cast:{int2string:dn,string2float:mn,float2string:pn},motion:{gotoxy:bn},looks:{think_debug_string:jn,think_string:Sn,say_float:vn,say_debug_string:xn,say_int:An,think_debug_int:Tn,think_float:Fn,switchcostumeto:Dn,say_debug_int:En,say_string:On,say_debug_float:Cn,setvisible:Ln,think_int:Pn,setsizeto:Mn,think_debug_float:zn}},Gn=await we(()=>import("./renderer-B_tnpBq2.js"),[]),Jn=Gn.default,Hn=ve();function Kn(t,e,n,..._){let s=t.createDrawable(n.toString());const a={pen:"Pen",text:"Text",svg:"SVG"}[e.toLowerCase()];let c=t[`create${a}Skin`](..._);return t.updateDrawableSkinId(s,c),[c,s]}function Xn(t,e,n,_){if(wn())return;let s=new Jn(t);s.getDrawable=i=>s._allDrawables[i],s.getSkin=i=>s._allSkins[i],s.createSkin=(i,p,...d)=>Kn(s,i,p,...d);const a=e.targets.map((i,p)=>i.costumes.map(({md5ext:d})=>n[d]));e.targets.map(i=>Object.fromEntries(i.costumes.map(({name:p},d)=>[p,d]))),window.renderer=s,s.setLayerGroupOrdering(["background","video","pen","sprite"]);const c=s.createSkin("pen","pen")[0],w=e.targets.map((i,p)=>{const d=i.costumes[i.currentCostume],y=a[p][i.currentCostume];if(y.dataFormat.toLowerCase()!=="svg")throw new Error("todo: non-svg costumes");const[m,D]=s.createSkin(y.dataFormat,"sprite",y.data,[d.rotationCenterX,d.rotationCenterY]),f=s.getDrawable(D);return i.is_stage||(f.updateVisible(!!i.visible),f.updatePosition([i.x,i.y]),f.updateDirection(i.direction),f.updateScale([i.size,i.size])),[m,D]});console.log(w),fn(_,s,c,w,a)}const Yn=async({framerate:t=30,turbo:e,canvas:n,wasm_bytes:_,target_names:s,string_consts:a,project_json:c,assets:w}={framerate:30,turbo:!1})=>{Hn.debug&&window.open(URL.createObjectURL(new Blob([_],{type:"application/wasm"})));const i=Math.round(1e3/t);Xn(n,c,w,s);const p=A();console.log("green flag setup complete");const y=[...N()["js-string-builtins"]?["js-string"]:[]];try{if(!WebAssembly.validate(_,{builtins:y}))throw Error()}catch{try{throw new WebAssembly.Module(_),new Error("invalid WASM module")}catch(f){throw new Error("invalid WASM module: "+f.message)}}function m(f){return new Promise(k=>{setTimeout(k,f)})}function D(){return new Promise(f=>{requestAnimationFrame(f)})}WebAssembly.instantiate(_,Nn,{builtins:y,importedStringConstants:""}).then(async({instance:f})=>{const{flag_clicked:k,tick:I,memory:z,step_funcs:g,vars_num:l,threads_count:T,requests_refresh:$,upc:ae,threads:B,noop:je,unreachable_dbg:Se}=f.exports;window.memory=z,window.flag_clicked=k,window.tick=I,window.stop=()=>{if(typeof B>"u"){let h=new Uint32Array(z.buffer);for(let Z=0;Z<T.value;Z++)h[Z]=0}else for(let h=0;h<B.length;h++)B.set(h,je);T.value=0},new DataView(z.buffer);try{Se()}catch(h){console.info("synthetic error to expose wasm module to devtools:",h)}k(),console.log("green_flag()");e:for(;;){p.draw();const h=Date.now();do if(I(),T.value===0)break e;while(Date.now()-h<i*.8&&!e&&$.value===0);$.value=0,i>0?await m(Math.max(0,i-(Date.now()-h))):await D()}}).catch(f=>{throw new Error(`error when instantiating module:
`+f.stack)})},Qn=["value"],Zn={key:0},e_=["innerHTML"],t_={__name:"ProjectPlayer",props:["json","title","author","assets","zip"],async setup(t){let e,n;const _=t;let s=F(null),a=F("loading"),c=F("An error"),w=F(!1),i=F(null),p=F("loading assets"),d=F(!1),y=null,m;const D=async g=>{try{return _.zip?await _.zip.file(g).async("text"):await(await fetch(`https://assets.scratch.mit.edu/internalapi/asset/${g}/get/`)).text()}catch(l){s.value=`failed to load asset ${g}
${l.stack}`}};let f,k;try{if(a.value="compiling",m=$e(JSON.stringify(_.json),U.from_js(N().to_js())),console.log(m),!m instanceof Y)throw new Error("unknown error occurred when compiling project");if(f=m.wasm_bytes,N().to_js().wasm_opt=="On")try{console.log("loading binaryen..."),console.log(N().to_js().scheduler);let g=([e,n]=Ae(()=>we(()=>import("./index-DE6qpayI.js"),__vite__mapDeps([0,1,2,3,4]))),e=await e,n(),e).default;console.log("optimising using wasm-opt..."),a.value="optimising",c.value="A warning";let l=g.readBinary(f);console.log(f.length),l.setFeatures(g.Features.All),g.setOptimizeLevel(3),g.setShrinkLevel(0),console.log(l.emitBinary().length),l.runPasses(["generate-global-effects"]),l.optimize(),console.log(l.emitBinary().length),console.log(l.emitBinary().length),l.optimize(),console.log(l.emitBinary().length),f=l.emitBinary(),console.log(f.length)}catch(g){console.error(g),s.value=g.message.toString(),g.stack&&(s.value+="<br>"+g.stack),s.value+="<br>See browser console for more info.        <brThis is not an unrecoverable error; the project should play         as normal (possibly with worse-than-expected performance).",k=!1}else console.log("skipping wasm-opt due to user settings");k=!0}catch(g){console.error(g),s.value=g.toString(),g.stack&&(s.value+="<br>"+g.stack),k=!1}console.log(m),Promise.all(_.json.targets.map(g=>new Promise(l=>Promise.all(g.costumes.map(({md5ext:T,dataFormat:$})=>new Promise(ae=>D(T).then(B=>ae([T,{dataFormat:$,data:B}]))))).then(l)))).then(g=>{y=Object.fromEntries(g.flat()),d.value=!0});function I(){k&&Yn({framerate:30,canvas:i.value,turbo:w.value,wasm_bytes:f,string_consts:m.strings,target_names:m.target_names,project_json:_.json,assets:y}).catch(g=>{console.error(g),c.value="An error",a.value="running",s.value=g.toString(),g.stack&&(s.value+=`
`+g.stack)})}function z(){window.stop()}return(g,l)=>(ee(),ce(Ce,null,[Te(b("div",null,[b("h1",null,V(_.title||"untitled"),1),b("span",null,"by "+V(_.author||"unknown"),1),b("input",{type:"checkbox",id:"turbo",value:j(w)},null,8,Qn),l[0]||(l[0]=W()),l[1]||(l[1]=b("label",{for:"turbo"},"turbo mode",-1)),j(s)?(ee(),ce("details",Zn,[b("summary",null,V(j(c))+" was emitted whilst "+V(j(a))+" project.",1),b("span",{innerHTML:j(s)},null,8,e_)])):ge("",!0),l[2]||(l[2]=b("br",null,null,-1)),l[3]||(l[3]=b("br",null,null,-1)),b("button",{onClick:I},"green flag"),l[4]||(l[4]=W()),b("button",{onClick:z},"stop"),b("canvas",{width:"480",height:"360",ref_key:"canvas",ref:i},null,512),l[5]||(l[5]=b("div",{id:"hq-output"},[W("Project output:"),b("br")],-1))],512),[[De,j(d)]]),j(d)?ge("",!0):(ee(),Fe(Oe,{key:0},{default:Ee(()=>[W(V(j(p)),1)]),_:1}))],64))}},s_=xe(t_,[["__scopeId","data-v-d692cea2"]]);export{s_ as P};
