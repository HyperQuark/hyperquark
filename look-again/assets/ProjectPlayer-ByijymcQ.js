const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DGZDnga_.js","assets/index-Bh8EGD6T.js","assets/index-Bh5bQtup.css","assets/index-BAMY2Nnw.js","assets/index-BATEtbik.js"])))=>i.map(i=>d[i]);
import{B as ye,C as ae,_ as ke,r as T,m as je,c as re,o as Y,h as Se,k as ve,s as se,D as xe,u as j,a as b,d as $,t as z,w as Ae,L as Te,F as De}from"./index-Bh8EGD6T.js";import{_ as Fe,g as q}from"./settings-BCkykcLt.js";const Ee="/hyperquark/look-again/assets/hyperquark_bg-BlWRPM32.wasm";let s;function Le(t){s=t}let I=null;function E(){return(I===null||I.byteLength===0)&&(I=new Uint8Array(s.memory.buffer)),I}function ce(t,e){return t=t>>>0,E().subarray(t/1,t/1+e)}function ge(t){const e=s.__externref_table_alloc();return s.__wbindgen_export_2.set(e,t),e}function Oe(t,e){try{return t.apply(this,e)}catch(n){const _=ge(n);s.__wbindgen_exn_store(_)}}const Ce=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let le=new Ce("utf-8",{ignoreBOM:!0,fatal:!0});le.decode();function v(t,e){return t=t>>>0,le.decode(E().subarray(t,t+e))}function Q(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const r=t.description;return r==null?"Symbol":`Symbol(${r})`}if(e=="function"){const r=t.name;return typeof r=="string"&&r.length>0?`Function(${r})`:"Function"}if(Array.isArray(t)){const r=t.length;let g="[";r>0&&(g+=Q(t[0]));for(let l=1;l<r;l++)g+=", "+Q(t[l]);return g+="]",g}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let _;if(n&&n.length>1)_=n[1];else return toString.call(t);if(_=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:_}let u=0;const Pe=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let N=new Pe("utf-8");const Me=typeof N.encodeInto=="function"?function(t,e){return N.encodeInto(t,e)}:function(t,e){const n=N.encode(t);return e.set(n),{read:t.length,written:n.length}};function S(t,e,n){if(n===void 0){const w=N.encode(t),i=e(w.length,1)>>>0;return E().subarray(i,i+w.length).set(w),u=w.length,i}let _=t.length,r=e(_,1)>>>0;const g=E();let l=0;for(;l<_;l++){const w=t.charCodeAt(l);if(w>127)break;g[r+l]=w}if(l!==_){l!==0&&(t=t.slice(l)),r=n(r,_,_=l+t.length*3,1)>>>0;const w=E().subarray(r+l,r+_),i=Me(t,w);l+=i.written,r=n(r,_,l,1)>>>0}return u=l,r}let F=null;function x(){return(F===null||F.buffer.detached===!0||F.buffer.detached===void 0&&F.buffer!==s.memory.buffer)&&(F=new DataView(s.memory.buffer)),F}function Z(t){return t==null}function fe(t,e){t=t>>>0;const n=x(),_=[];for(let r=t;r<t+4*e;r+=4)_.push(s.__wbindgen_export_2.get(n.getUint32(r,!0)));return s.__externref_drop_slice(t,e),_}function L(t){const e=s.__wbindgen_export_2.get(t);return s.__externref_table_dealloc(t),e}function we(t,e){const n=e(t.length*4,4)>>>0;for(let _=0;_<t.length;_++){const r=ge(t[_]);x().setUint32(n+4*_,r,!0)}return u=t.length,n}function ze(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`)}function Be(t,e){const n=S(t,s.__wbindgen_malloc,s.__wbindgen_realloc),_=u;ze(e,R);var r=e.__destroy_into_raw();const g=s.sb3_to_wasm(n,_,r);if(g[2])throw L(g[1]);return H.__wrap(g[0])}function Re(t,e){const n=e(t.length*1,1)>>>0;return E().set(t,n/1),u=t.length,n}const oe=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_finishedwasm_free(t>>>0,1));class H{static __wrap(e){e=e>>>0;const n=Object.create(H.prototype);return n.__wbg_ptr=e,oe.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,oe.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_finishedwasm_free(e,0)}get wasm_bytes(){const e=s.__wbg_get_finishedwasm_wasm_bytes(this.__wbg_ptr);var n=ce(e[0],e[1]).slice();return s.__wbindgen_free(e[0],e[1]*1,1),n}set wasm_bytes(e){const n=Re(e,s.__wbindgen_malloc),_=u;s.__wbg_set_finishedwasm_wasm_bytes(this.__wbg_ptr,n,_)}get target_names(){const e=s.__wbg_get_finishedwasm_target_names(this.__wbg_ptr);var n=fe(e[0],e[1]).slice();return s.__wbindgen_free(e[0],e[1]*4,4),n}set target_names(e){const n=we(e,s.__wbindgen_malloc),_=u;s.__wbg_set_finishedwasm_target_names(this.__wbg_ptr,n,_)}}const ie=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_flaginfo_free(t>>>0,1));class ee{static __wrap(e){e=e>>>0;const n=Object.create(ee.prototype);return n.__wbg_ptr=e,ie.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,ie.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_flaginfo_free(e,0)}get name(){let e,n;try{const _=s.__wbg_get_flaginfo_name(this.__wbg_ptr);return e=_[0],n=_[1],v(_[0],_[1])}finally{s.__wbindgen_free(e,n,1)}}set name(e){const n=S(e,s.__wbindgen_malloc,s.__wbindgen_realloc),_=u;s.__wbg_set_flaginfo_name(this.__wbg_ptr,n,_)}get description(){let e,n;try{const _=s.__wbg_get_flaginfo_description(this.__wbg_ptr);return e=_[0],n=_[1],v(_[0],_[1])}finally{s.__wbindgen_free(e,n,1)}}set description(e){const n=S(e,s.__wbindgen_malloc,s.__wbindgen_realloc),_=u;s.__wbg_set_flaginfo_description(this.__wbg_ptr,n,_)}get ty(){let e,n;try{const _=s.__wbg_get_flaginfo_ty(this.__wbg_ptr);return e=_[0],n=_[1],v(_[0],_[1])}finally{s.__wbindgen_free(e,n,1)}}set ty(e){const n=S(e,s.__wbindgen_malloc,s.__wbindgen_realloc),_=u;s.__wbg_set_flaginfo_ty(this.__wbg_ptr,n,_)}wasm_features(e){const n=S(e,s.__wbindgen_malloc,s.__wbindgen_realloc),_=u,r=s.flaginfo_wasm_features(this.__wbg_ptr,n,_);let g;return r[0]!==0&&(g=fe(r[0],r[1]).slice(),s.__wbindgen_free(r[0],r[1]*4,4)),g}to_js(){const e=s.flaginfo_to_js(this.__wbg_ptr);if(e[2])throw L(e[1]);return L(e[0])}}const K=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>s.__wbg_wasmflags_free(t>>>0,1));class R{static __wrap(e){e=e>>>0;const n=Object.create(R.prototype);return n.__wbg_ptr=e,K.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,K.unregister(this),e}free(){const e=this.__destroy_into_raw();s.__wbg_wasmflags_free(e,0)}get string_type(){return s.__wbg_get_wasmflags_string_type(this.__wbg_ptr)}set string_type(e){s.__wbg_set_wasmflags_string_type(this.__wbg_ptr,e)}get wasm_opt(){return s.__wbg_get_wasmflags_wasm_opt(this.__wbg_ptr)}set wasm_opt(e){s.__wbg_set_wasmflags_wasm_opt(this.__wbg_ptr,e)}get scheduler(){return s.__wbg_get_wasmflags_scheduler(this.__wbg_ptr)}set scheduler(e){s.__wbg_set_wasmflags_scheduler(this.__wbg_ptr,e)}get print_ir(){return s.__wbg_get_wasmflags_print_ir(this.__wbg_ptr)}set print_ir(e){s.__wbg_set_wasmflags_print_ir(this.__wbg_ptr,e)}get integers(){return s.__wbg_get_wasmflags_integers(this.__wbg_ptr)}set integers(e){s.__wbg_set_wasmflags_integers(this.__wbg_ptr,e)}constructor(e){const n=we(e,s.__wbindgen_malloc),_=u,r=s.wasmflags_new(n,_);return this.__wbg_ptr=r>>>0,K.register(this,this.__wbg_ptr,this),this}to_js(){const e=s.wasmflags_to_js(this.__wbg_ptr);if(e[2])throw L(e[1]);return L(e[0])}static from_js(e){const n=s.wasmflags_from_js(e);if(n[2])throw L(n[1]);return R.__wrap(n[0])}static flag_info(e){const n=S(e,s.__wbindgen_malloc,s.__wbindgen_realloc),_=u,r=s.wasmflags_flag_info(n,_);return ee.__wrap(r)}}function Ve(t){return t.buffer}function Ue(t){return Object.entries(t)}function We(){return Oe(function(t,e){globalThis.crypto.getRandomValues(ce(t,e))},arguments)}function $e(t,e){return t[e>>>0]}function Ie(t,e){return t[e]}function qe(t){let e;try{e=t instanceof ArrayBuffer}catch{e=!1}return e}function Ne(t){let e;try{e=t instanceof Uint8Array}catch{e=!1}return e}function Ge(t){return t.length}function Je(t){return t.length}function He(t,e){console.log(v(t,e))}function Xe(){return new Object}function Ye(){return new Map}function Ke(){return new Array}function Qe(t){return new Uint8Array(t)}function Ze(t,e,n){t[e>>>0]=n}function et(t,e,n){t[e]=n}function tt(t,e,n){t.set(e,n>>>0)}function nt(t,e,n){return t.set(e,n)}function _t(t,e){console.warn(v(t,e))}function rt(t){const e=t;return typeof e=="boolean"?e?1:0:2}function st(t,e){const n=Q(e),_=S(n,s.__wbindgen_malloc,s.__wbindgen_realloc),r=u;x().setInt32(t+4,r,!0),x().setInt32(t+0,_,!0)}function ot(t,e){return new Error(v(t,e))}function it(t,e){return t in e}function at(){const t=s.__wbindgen_export_2,e=t.grow(4);t.set(0,void 0),t.set(e+0,void 0),t.set(e+1,null),t.set(e+2,!0),t.set(e+3,!1)}function ct(t){const e=t;return typeof e=="object"&&e!==null}function gt(t){return typeof t=="string"}function lt(t){return t===void 0}function ft(t,e){return t==e}function wt(){return s.memory}function ut(t,e){const n=e,_=typeof n=="number"?n:void 0;x().setFloat64(t+8,Z(_)?0:_,!0),x().setInt32(t+0,!Z(_),!0)}function bt(t){return t}function dt(t,e){const n=e,_=typeof n=="string"?n:void 0;var r=Z(_)?0:S(_,s.__wbindgen_malloc,s.__wbindgen_realloc),g=u;x().setInt32(t+4,g,!0),x().setInt32(t+0,r,!0)}function mt(t,e){return v(t,e)}function pt(t,e){throw new Error(v(t,e))}function ht(t){let e;try{e=+t}catch(_){e=_}return e}URL=globalThis.URL;const o=await Fe({"./hyperquark_bg.js":{__wbg_log_aa56095730005220:He,__wbindgen_error_new:ot,__wbindgen_number_new:bt,__wbindgen_string_new:mt,__wbindgen_try_into_number:ht,__wbindgen_number_get:ut,__wbg_warn_696c245f3c7d1eea:_t,__wbindgen_string_get:dt,__wbindgen_is_string:gt,__wbindgen_is_undefined:lt,__wbindgen_in:it,__wbindgen_is_object:ct,__wbindgen_jsval_loose_eq:ft,__wbindgen_boolean_get:rt,__wbg_getwithrefkey_1dc361bd10053bfe:Ie,__wbg_set_3f1d0b984ed272ed:et,__wbg_new_5e0be73521bc8c17:Ye,__wbg_new_78feb108b6472713:Ke,__wbg_new_405e22f390576ce2:Xe,__wbg_new_a12002a7f91c75be:Qe,__wbg_buffer_609cc3eee51ed158:Ve,__wbg_set_65595bdd868b3009:tt,__wbg_length_a446193dc22c12f8:Ge,__wbg_instanceof_Uint8Array_17156bcf118086a9:Ne,__wbg_instanceof_ArrayBuffer_e14585432e3737fc:qe,__wbg_set_8fc6bf8a5b1071d1:nt,__wbg_get_b9b93047fe3cf45b:$e,__wbg_set_37837023f3d740e8:Ze,__wbg_length_e2d2a49132c1b256:Je,__wbg_entries_3265d4158b33e5dc:Ue,__wbg_getRandomValues_e14bd3de0db61032:We,__wbindgen_memory:wt,__wbindgen_throw:pt,__wbindgen_debug_string:st,__wbindgen_init_externref_table:at}},Ee),yt=o.memory,kt=o.__wbg_flaginfo_free,jt=o.__wbg_get_flaginfo_description,St=o.__wbg_get_flaginfo_name,vt=o.__wbg_get_flaginfo_ty,xt=o.__wbg_get_wasmflags_integers,At=o.__wbg_get_wasmflags_print_ir,Tt=o.__wbg_get_wasmflags_scheduler,Dt=o.__wbg_get_wasmflags_string_type,Ft=o.__wbg_get_wasmflags_wasm_opt,Et=o.__wbg_set_flaginfo_description,Lt=o.__wbg_set_flaginfo_name,Ot=o.__wbg_set_flaginfo_ty,Ct=o.__wbg_set_wasmflags_integers,Pt=o.__wbg_set_wasmflags_print_ir,Mt=o.__wbg_set_wasmflags_scheduler,zt=o.__wbg_set_wasmflags_string_type,Bt=o.__wbg_set_wasmflags_wasm_opt,Rt=o.__wbg_wasmflags_free,Vt=o.all_wasm_features,Ut=o.flaginfo_to_js,Wt=o.flaginfo_wasm_features,$t=o.wasm_feature_detect_name,It=o.wasmflags_flag_info,qt=o.wasmflags_from_js,Nt=o.wasmflags_new,Gt=o.wasmflags_to_js,Jt=o.sb3_to_wasm,Ht=o.__wbg_finishedwasm_free,Xt=o.__wbg_get_finishedwasm_target_names,Yt=o.__wbg_get_finishedwasm_wasm_bytes,Kt=o.__wbg_set_finishedwasm_target_names,Qt=o.__wbg_set_finishedwasm_wasm_bytes,Zt=o.__wbindgen_exn_store,en=o.__externref_table_alloc,tn=o.__wbindgen_export_2,nn=o.__wbindgen_malloc,_n=o.__wbindgen_realloc,rn=o.__wbindgen_free,sn=o.__externref_drop_slice,on=o.__externref_table_dealloc,ue=o.__wbindgen_start,an=Object.freeze(Object.defineProperty({__proto__:null,__externref_drop_slice:sn,__externref_table_alloc:en,__externref_table_dealloc:on,__wbg_finishedwasm_free:Ht,__wbg_flaginfo_free:kt,__wbg_get_finishedwasm_target_names:Xt,__wbg_get_finishedwasm_wasm_bytes:Yt,__wbg_get_flaginfo_description:jt,__wbg_get_flaginfo_name:St,__wbg_get_flaginfo_ty:vt,__wbg_get_wasmflags_integers:xt,__wbg_get_wasmflags_print_ir:At,__wbg_get_wasmflags_scheduler:Tt,__wbg_get_wasmflags_string_type:Dt,__wbg_get_wasmflags_wasm_opt:Ft,__wbg_set_finishedwasm_target_names:Kt,__wbg_set_finishedwasm_wasm_bytes:Qt,__wbg_set_flaginfo_description:Et,__wbg_set_flaginfo_name:Lt,__wbg_set_flaginfo_ty:Ot,__wbg_set_wasmflags_integers:Ct,__wbg_set_wasmflags_print_ir:Pt,__wbg_set_wasmflags_scheduler:Mt,__wbg_set_wasmflags_string_type:zt,__wbg_set_wasmflags_wasm_opt:Bt,__wbg_wasmflags_free:Rt,__wbindgen_exn_store:Zt,__wbindgen_export_2:tn,__wbindgen_free:rn,__wbindgen_malloc:nn,__wbindgen_realloc:_n,__wbindgen_start:ue,all_wasm_features:Vt,flaginfo_to_js:Ut,flaginfo_wasm_features:Wt,memory:yt,sb3_to_wasm:Jt,wasm_feature_detect_name:$t,wasmflags_flag_info:It,wasmflags_from_js:qt,wasmflags_new:Nt,wasmflags_to_js:Gt},Symbol.toStringTag,{value:"Module"}));Le(an);ue();function cn(t){return t.toString()}function gn(t){return parseFloat(t)}function ln(t){return t.toString()}let G,te=!1,B,J,be,de;function fn(t,e,n,_,r){G=t,B=G.map(g=>null),console.log(G,B),J=e,be=_,de=r,te=!0}function wn(){return te}function V(){if(!te)throw new Error("shared state must be set up before use!")}function O(){return V(),G}function ne(){return V(),J}function me(){return V(),be}function un(){return V(),de}function C(t,e,n){V(),B[t]?J.updateTextSkin(B[t][0],e,n,!1):B[t]=J.createSkin("text","sprite",e,n,!1)}function bn(t,e){C(e,"say",t.toString())}function dn(t,e){console.log("%s says: %d",O()[e],t)}function mn(t,e){C(e,"say",t.toString())}function pn(t,e){console.log("%s thinks: %d",O()[e],t)}function hn(t,e){C(e,"think",t.toString())}function yn(t,e){console.log("%s thinks: %s",O()[e],t)}function kn(t,e){console.log("%s says: %d",O()[e],t)}function jn(t,e){C(e,"think",t)}function Sn(t,e){ne().getDrawable(me()[e][1]).updateScale([t,t])}function vn(t,e){C(e,"say",t)}function xn(t,e){const n=un()[e][t];ne().getSkin(me()[e][0]).setSVG(n.data)}function An(t,e){C(e,"think",t.toString())}function Tn(t,e){console.log("%s thinks: %d",O()[e],t)}function Dn(t,e){console.log("%s says: %s",O()[e],t)}function Fn(t,e){return t.concat(e)}function En(t,e,n){return t.substring(e,n)}function Ln(t){return t.length}function On(){const e=new Date(2e3,0,1),n=new Date,_=n.getTimezoneOffset()-e.getTimezoneOffset();let r=n.valueOf()-e.valueOf();return r+=(n.getTimezoneOffset()-_)*60*1e3,r/864e5}function Cn(t,e){return t.toLowerCase()<e.toLowerCase()}function Pn(t,e){return t.toLowerCase()===e.toLowerCase()}function Mn(t,e){return t.toLowerCase()>e.toLowerCase()}function zn(t,e){return t.toLowerCase().includes(e.toLowerCase())}const Bn={"wasm:js-string":{concat:Fn,substring:En,length:Ln},operator:{lt_string:Cn,eq_string:Pn,gt_string:Mn,contains:zn},cast:{int2string:cn,string2float:gn,float2string:ln},sensing:{dayssince2000:On},looks:{say_int:bn,say_debug_float:dn,say_float:mn,think_debug_int:pn,think_float:hn,think_debug_string:yn,say_debug_int:kn,think_string:jn,setsizeto:Sn,say_string:vn,switchcostumeto:xn,think_int:An,think_debug_float:Tn,say_debug_string:Dn}},Rn=await ae(()=>import("./renderer-B_tnpBq2.js"),[]),Vn=Rn.default,Un=ye();function Wn(t,e,n,..._){let r=t.createDrawable(n.toString());const g={pen:"Pen",text:"Text",svg:"SVG"}[e.toLowerCase()];let l=t[`create${g}Skin`](..._);return t.updateDrawableSkinId(r,l),[l,r]}function $n(t,e,n,_){if(wn())return;let r=new Vn(t);r.getDrawable=i=>r._allDrawables[i],r.getSkin=i=>r._allSkins[i],r.createSkin=(i,p,...d)=>Wn(r,i,p,...d);const g=e.targets.map((i,p)=>i.costumes.map(({md5ext:d})=>n[d]));e.targets.map(i=>Object.fromEntries(i.costumes.map(({name:p},d)=>[p,d]))),window.renderer=r,r.setLayerGroupOrdering(["background","video","pen","sprite"]);const l=r.createSkin("pen","pen")[0],w=e.targets.map((i,p)=>{const d=i.costumes[i.currentCostume],y=g[p][i.currentCostume];if(y.dataFormat.toLowerCase()!=="svg")throw new Error("todo: non-svg costumes");const[m,D]=r.createSkin(y.dataFormat,"sprite",y.data,[d.rotationCenterX,d.rotationCenterY]),f=r.getDrawable(D);return i.is_stage||(f.updateVisible(!!i.visible),f.updatePosition([i.x,i.y]),f.updateDirection(i.direction),f.updateScale([i.size,i.size])),[m,D]});console.log(w),fn(_,r,l,w,g)}const In=async({framerate:t=30,turbo:e,canvas:n,wasm_bytes:_,target_names:r,string_consts:g,project_json:l,assets:w}={framerate:30,turbo:!1})=>{Un.debug&&window.open(URL.createObjectURL(new Blob([_],{type:"application/wasm"})));const i=Math.round(1e3/t);$n(n,l,w,r);const p=ne();console.log("green flag setup complete");const y=[...q()["js-string-builtins"]?["js-string"]:[]];try{if(!WebAssembly.validate(_,{builtins:y}))throw Error()}catch{try{throw new WebAssembly.Module(_),new Error("invalid WASM module")}catch(f){throw new Error("invalid WASM module: "+f.message)}}function m(f){return new Promise(k=>{setTimeout(k,f)})}function D(){return new Promise(f=>{requestAnimationFrame(f)})}WebAssembly.instantiate(_,Bn,{builtins:y,importedStringConstants:""}).then(async({instance:f})=>{const{flag_clicked:k,tick:U,memory:P,step_funcs:a,vars_num:c,threads_count:A,requests_refresh:W,upc:_e,threads:M,noop:pe,unreachable_dbg:he}=f.exports;window.memory=P,window.flag_clicked=k,window.tick=U,window.stop=()=>{if(typeof M>"u"){let h=new Uint32Array(P.buffer);for(let X=0;X<A.value;X++)h[X]=0}else for(let h=0;h<M.length;h++)M.set(h,pe);A.value=0},new DataView(P.buffer);try{he()}catch(h){console.info("synthetic error to expose wasm module to devtools:",h)}k(),console.log("green_flag()");e:for(;;){p.draw();const h=Date.now();do if(U(),A.value===0)break e;while(Date.now()-h<i*.8&&!e&&W.value===0);W.value=0,i>0?await m(Math.max(0,i-(Date.now()-h))):await D()}}).catch(f=>{throw new Error(`error when instantiating module:
`+f.stack)})},qn=["value"],Nn={key:0},Gn=["innerHTML"],Jn={__name:"ProjectPlayer",props:["json","title","author","assets","zip"],async setup(t){let e,n;const _=t;let r=T(null),g=T("loading"),l=T("An error"),w=T(!1),i=T(null),p=T("loading assets"),d=T(!1),y=null,m;const D=async a=>{try{return _.zip?await _.zip.file(a).async("text"):await(await fetch(`https://assets.scratch.mit.edu/internalapi/asset/${a}/get/`)).text()}catch(c){r.value=`failed to load asset ${a}
${c.stack}`}};let f,k;try{if(g.value="compiling",m=Be(JSON.stringify(_.json),R.from_js(q().to_js())),console.log(m),!m instanceof H)throw new Error("unknown error occurred when compiling project");if(f=m.wasm_bytes,q().to_js().wasm_opt=="On")try{console.log("loading binaryen..."),console.log(q().to_js().scheduler);let a=([e,n]=je(()=>ae(()=>import("./index-DGZDnga_.js"),__vite__mapDeps([0,1,2,3,4]))),e=await e,n(),e).default;console.log("optimising using wasm-opt..."),g.value="optimising",l.value="A warning";let c=a.readBinary(f);console.log(f.length),c.setFeatures(a.Features.All),a.setOptimizeLevel(3),a.setShrinkLevel(0),console.log(c.emitBinary().length),c.runPasses(["generate-global-effects"]),c.optimize(),console.log(c.emitBinary().length),console.log(c.emitBinary().length),c.optimize(),console.log(c.emitBinary().length),f=c.emitBinary(),console.log(f.length)}catch(a){console.error(a),r.value=a.message.toString(),a.stack&&(r.value+="<br>"+a.stack),r.value+="<br>See browser console for more info.        <brThis is not an unrecoverable error; the project should play         as normal (possibly with worse-than-expected performance).",k=!1}else console.log("skipping wasm-opt due to user settings");k=!0}catch(a){console.error(a),r.value=a.toString(),a.stack&&(r.value+="<br>"+a.stack),k=!1}console.log(m),Promise.all(_.json.targets.map(a=>new Promise(c=>Promise.all(a.costumes.map(({md5ext:A,dataFormat:W})=>new Promise(_e=>D(A).then(M=>_e([A,{dataFormat:W,data:M}]))))).then(c)))).then(a=>{y=Object.fromEntries(a.flat()),d.value=!0});function U(){k&&In({framerate:30,canvas:i.value,turbo:w.value,wasm_bytes:f,string_consts:m.strings,target_names:m.target_names,project_json:_.json,assets:y}).catch(a=>{console.error(a),l.value="An error",g.value="running",r.value=a.toString(),a.stack&&(r.value+=`
`+a.stack)})}function P(){window.stop()}return(a,c)=>(Y(),re(De,null,[Se(b("div",null,[b("h1",null,z(_.title||"untitled"),1),b("span",null,"by "+z(_.author||"unknown"),1),b("input",{type:"checkbox",id:"turbo",value:j(w)},null,8,qn),c[0]||(c[0]=$()),c[1]||(c[1]=b("label",{for:"turbo"},"turbo mode",-1)),j(r)?(Y(),re("details",Nn,[b("summary",null,z(j(l))+" was emitted whilst "+z(j(g))+" project.",1),b("span",{innerHTML:j(r)},null,8,Gn)])):se("",!0),c[2]||(c[2]=b("br",null,null,-1)),c[3]||(c[3]=b("br",null,null,-1)),b("button",{onClick:U},"green flag"),c[4]||(c[4]=$()),b("button",{onClick:P},"stop"),b("canvas",{width:"480",height:"360",ref_key:"canvas",ref:i},null,512),c[5]||(c[5]=b("div",{id:"hq-output"},[$("Project output:"),b("br")],-1))],512),[[xe,j(d)]]),j(d)?se("",!0):(Y(),ve(Te,{key:0},{default:Ae(()=>[$(z(j(p)),1)]),_:1}))],64))}},Yn=ke(Jn,[["__scopeId","data-v-d692cea2"]]);export{Yn as P};
